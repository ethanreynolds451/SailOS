Not fully tested, use at your own risk